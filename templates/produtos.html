<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Produtos Cadastrados</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">

  <!-- CSS RESPONSIVO INSERIDO -->
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
    }

    /* ===== MOBILE ===== */
    @media (max-width: 768px) {

      /* MENU */
      .menu {
        flex-direction: column;
        gap: 15px;
      }

      .menu ul {
        flex-direction: column;
        gap: 12px;
        padding: 0;
      }

      /* TÍTULO */
      h2 {
        font-size: 22px !important;
      }

      /* BUSCA */
      #busca {
        width: 100% !important;
        max-width: 100%;
      }

      /* GRID */
      #lista-produtos {
        grid-template-columns: 1fr !important;
      }

      /* CARDS */
      #lista-produtos > div {
        padding: 18px !important;
        text-align: center;
      }
    }
  </style>
</head>
<body>

<header>
  <nav class="menu">
    <span class="logo">Gil Eletrônicos</span>
    <ul>
      <li><a href="/">Início</a></li>
      <li><a href="/cadastro">Cadastrar Produto</a></li>
      <li><a href="/produtos">Produtos Cadastrados</a></li>
      <li><a href="/suporte">Suporte</a></li>
    </ul>
  </nav>
</header>

<main style="
  flex:1;
  background:#f4f6fb;
  display:flex;
  justify-content:center;
  padding:40px 20px;
">
  <div style="width:100%; max-width:1100px;">

    <h2 style="
      text-align:center;
      margin-bottom:25px;
      font-size:28px;
      color:#1a1a2e;
    ">
      Produtos Cadastrados
    </h2>

    <!-- BUSCA -->
    <div style="display:flex; justify-content:center; margin-bottom:35px;">
      <input 
        type="text" 
        id="busca" 
        placeholder="Buscar produto..."
        style="
          padding:14px 18px;
          width:320px;
          border-radius:12px;
          border:2px solid #ddd;
          font-size:16px;
          outline:none;
        "
      >
    </div>

    <!-- LISTA -->
    <div 
      id="lista-produtos"
      style="
        display:grid;
        grid-template-columns:repeat(auto-fill, minmax(260px, 1fr));
        gap:25px;
      "
    ></div>

  </div>
</main>

<script>
async function carregarProdutos(busca = '') {
  const response = await fetch(`/api/produtos?search=${busca}`);
  const produtos = await response.json();

  const lista = document.getElementById('lista-produtos');
  lista.innerHTML = '';

  if (produtos.length === 0) {
    lista.innerHTML = `
      <p style="
        grid-column:1/-1;
        text-align:center;
        color:#777;
      ">
        Nenhum produto encontrado.
      </p>
    `;
    return;
  }

  produtos.forEach(p => {
    lista.innerHTML += `
      <div style="
        background:#fff;
        padding:22px;
        border-radius:18px;
        box-shadow:0 10px 25px rgba(0,0,0,.08);
      ">

        <h3 style="margin-bottom:8px; color:#1a1a2e; font-size:18px;">
          ${p.nome}
        </h3>

        <div style="color:#777; font-size:14px; margin-bottom:10px;">
          ${p.categoria}
        </div>

        <div style="color:#00d1ff; font-size:18px; font-weight:700; margin-bottom:12px;">
          R$ ${p.preco.toFixed(2)}
        </div>

        <p style="font-size:14px; color:#333; line-height:1.4;">
          ${p.descricao || ''}
        </p>

      </div>
    `;
  });
}

document.getElementById('busca').addEventListener('input', e => {
  carregarProdutos(e.target.value);
});

carregarProdutos();
</script>

</body>
</html>
